#!/bin/bash
#
# ConoHaのCentOS 7.1のSSHのポート番号を変更するシェルスクリプト
#

if [ `id -u` -ne 0 ]
then
	echo "Re-run this program as the super user." >&2
	exit 1
fi

# ----------------------------------------------------------------------
# 1. SSHの設定
# ----------------------------------------------------------------------
sed -e "s/^#Port 22$/Port 10022/" -i /etc/ssh/sshd_config

# ----------------------------------------------------------------------
# 2. ファイアウォールの設定
# ----------------------------------------------------------------------
sed -e "s/22/10022/" -i /usr/lib/firewalld/services/ssh.xml

# ----------------------------------------------------------------------
# 3. システムの再起動
# ----------------------------------------------------------------------
shutdown -r now

exit 0
